# Windows

- shell:
    - description: Set XDG environment variables
      command: >
        powershell.exe
        -NoProfile
        -NoLogo
        -NonInteractive
        -Command "
        [Environment]::SetEnvironmentVariable(\"XDG_CONFIG_HOME\", \"$env:USERPROFILE\.config\", \"User\");
        [Environment]::SetEnvironmentVariable(\"XDG_CACHE_HOME\", \"$env:USERPROFILE\.cache\", \"User\");
        [Environment]::SetEnvironmentVariable(\"XDG_STATE_HOME\", \"$env:USERPROFILE\.local\state\", \"User\");
        [Environment]::SetEnvironmentVariable(\"XDG_DATA_HOME\", \"$env:USERPROFILE\.local\share\", \"User\");
        [Environment]::SetEnvironmentVariable(\"GOPATH\", \"$env:USERPROFILE\.local\share\go\", \"User\");
        "

- shell:
    - description: Hide some directories in Home
      command: >
        powershell.exe
        -NoProfile
        -NoLogo
        -NonInteractive
        -Command "Get-ChildItem -Path ~ -Filter .* | ForEach-Object { $_.Attributes += \"Hidden\" }"

- shell:
    - description: Set natural scrolling for mouses
      command: >
        powershell.exe
        -NoProfile
        -NoLogo
        -NonInteractive
        -Command "
        $mouseDevices = Get-ItemProperty 'HKLM:\SYSTEM\CurrentControlSet\Enum\HID\*\*\Device Parameters' FlipFlopWheel -ErrorAction SilentlyContinue;
        foreach ($device in $mouseDevices) { Set-ItemProperty $device.PSPath FlipFlopWheel 1 }
        "

- shell:
    - description: Set up OpenSSH server and client
    # Test using: ssh computername\username@localhost
      command: >
        powershell.exe
        -NoProfile
        -NoLogo
        -NonInteractive
        -Command "
        Add-WindowsCapability -Online -Name OpenSSH.Client;
        Add-WindowsCapability -Online -Name OpenSSH.Server;
        Start-Service sshd;
        Set-Service -Name sshd -StartupType 'Automatic';
        New-ItemProperty -Path 'HKLM:\SOFTWARE\OpenSSH' -Name DefaultShell -Value 'C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe' -PropertyType String -Force
        "
